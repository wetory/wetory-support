(function(b){function g(){var a=b(".filter-summary span.displayed-posts-count"),d=b(".filter-summary span.total-posts-count");if(a){var c=wp_query.posts_per_page*wp_query.current_page;c=c>wp_query.found_posts?wp_query.found_posts:c;a.text(c)}d&&d.text(wp_query.found_posts)}b.fn.serializeAssoc=function(){var a={};b.each(this.serializeArray(),function(d,c){var e=c.name.match(/(.*?)\[(.*?)\]/);null!==e?(d=e[1],e=e[2],a[d]||(a[d]=[]),e.length||(e=a[d].length),a[d][e]?(b.isArray(a[d][e])||(a[d][e]=[]),
a[d][e].push(c.value)):a[d][e]=c.value):a[c.name]?(b.isArray(a[c.name])||(a[c.name]=[]),a[c.name].push(c.value)):a[c.name]=c.value});return a};b(window).load(function(){var a=b("form.wetory-ajax-filter");0!==a.length&&a.hasClass("autoload")&&a.submit()});b(function(){});b('form.wetory-ajax-filter button[type="submit"]').click(function(a){a.preventDefault();b("form.wetory-ajax-filter").submit();return!1});b('form.wetory-ajax-filter button[type="reset"]').click(function(a){this.form.reset();b("form.wetory-ajax-filter").submit();
return!1});b("form.wetory-ajax-filter").submit(function(){var a=b(this),d=a.find(".filter-status"),c=a.find(".filter-summary"),e=b(".wetory-ajax-post-list"),f=e.attr("data-loadmore-template"),h=b(".wetory-ajax-loadmore");f={action:"wetory_ajax_filter",query:wp_query.query,form:a.serializeAssoc(),template:f};b.ajax({url:parameters.ajaxurl,data:f,dataType:"json",type:"POST",beforeSend:function(b){a.find('button[type="submit"]').addClass("loading");d&&d.addClass("loading");c&&c.hide()},success:function(a){e.is("table")?
e.find("tbody").html(a.html):e.html(a.html);wp_query.query=a.query;wp_query.posts_per_page=a.posts_per_page;wp_query.current_page=1;wp_query.found_posts=a.found_posts;wp_query.max_num_pages=a.max_num_pages;g();c&&c.show();wp_query.current_page>=wp_query.max_num_pages?h.hide():h.show()},complete:function(b){a.find('button[type="submit"]').removeClass("loading");d&&d.removeClass("loading")}});return!1});b(".wetory-ajax-loadmore").click(function(){var a=b(this),d=b(".wetory-ajax-post-list"),c=d.attr("data-loadmore-template");
b.ajax({url:parameters.ajaxurl,data:{action:"wetory_ajax_loadmore",query:wp_query.query,page:wp_query.current_page,template:c},type:"POST",beforeSend:function(b){a.addClass("loading")},success:function(b){b?(d.append(b),wp_query.current_page++,g(),wp_query.current_page>=wp_query.max_num_pages&&a.hide()):a.hide()},complete:function(b){a.removeClass("loading")}});return!1})})(jQuery);